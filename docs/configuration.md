# Configuration

lctx stores its configuration at `~/.config/lctx/config.json`. This file is created automatically on first run.

## Config Structure

| Field              | Description                                                         |
|--------------------|---------------------------------------------------------------------|
| `sourcesDirectory` | Where sources are cloned/stored (default: `~/.config/lctx/sources`) |
| `sources`          | Array of configured sources                                         |
| `agents`           | Agent command templates (keyed by agent name)                       |
| `defaultAgent`     | Which agent to use by default                                       |

## Agent Configuration

Each agent requires a command template that lctx uses to spawn subagents:

```json
{
  "claude-code": {
    "commands": {
      "chat": "claude",
      "ask": "claude --strict-mcp-config --mcp-config {mcp_config_file} -p {prompt_file}"
    },
    "addDirFlag": "--add-dir {path}",
    "mcp": {
      "path": ".mcp.json",
      "config": { "mcpServers": {} }
    }
  }
}
```

## Command Placeholders

| Placeholder         | Replaced With                                 | Used In                         |
|---------------------|-----------------------------------------------|---------------------------------|
| `{prompt_file}`     | Path to autogenerated `prompt.md` in temp dir | `commands.ask`                  |
| `{mcp_config_file}` | Path to MCP config file in temp dir           | `commands.ask`                  |
| `{working_dir}`     | Temp directory path                           | `commands.ask`, `commands.chat` |
| `{path}`            | Resolved source path                          | `addDirFlag`                    |

## How addDirFlag Works

The `addDirFlag` template is applied **for each source** requested. For example, with sources `langchain` and `bun`:

```
addDirFlag: "--add-dir {path}"
```

Becomes:
- `--add-dir ~/.config/lctx/sources/langchain`
- `--add-dir ~/.config/lctx/sources/bun`

These arguments are appended to the base command.

## Command Construction Example

Given: `lctx ask -s langchain bun -q "How to create an agent?"`

**Base command** (after placeholder interpolation):
```
claude --strict-mcp-config --mcp-config /tmp/lctx-uuid/.mcp.json -p /tmp/lctx-uuid/prompt.md
```

**Final command** (with addDirFlag for each source):
```
claude --strict-mcp-config --mcp-config /tmp/lctx-uuid/.mcp.json -p /tmp/lctx-uuid/prompt.md --add-dir ~/.config/lctx/sources/git/langchain --add-dir ~/.config/lctx/sources/docs/bun/content.txt
```

## MCP Config

Defines the MCP configuration file written to the subagent's temp directory. This controls which MCP servers the subagent can access.

| Field    | Description                                                                                                                                                  |
|----------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `path`   | Where to write the MCP config (relative to temp dir). Different agents use different paths: `.mcp.json` for Claude Code, `.cursor/mcp.json` for Cursor, etc. |
| `config` | The MCP configuration content. Usually empty (`{ "mcpServers": {} }`) to block all MCP tools.                                                                |

**Why this matters:** Each CLI agent has its own MCP config location and format. By making this configurable, lctx works with any agent.

**Critical:** Never include `lctx` in the subagent's MCP configâ€”this creates a circular dependency where the subagent calls lctx, which spawns another subagent, infinitely.
